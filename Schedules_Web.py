import pandas as pd
import streamlit as st
import io
import base64

# Embedded Excel content (base64 encoded)
embedded_excel = """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
"""

# Decode and load the Excel file
excel_bytes = base64.b64decode(embedded_excel)
xls = pd.ExcelFile(io.BytesIO(excel_bytes))
df = xls.parse("Staff", header=None)

# Extract the name column and the data
names = df.iloc[2:, 0].dropna().unique()

# Extract years and semesters from first two rows
year_row = df.iloc[0, 1:]
semester_row = df.iloc[1, 1:]
columns = list(zip(year_row, semester_row))

# Build a structured mapping: year -> semester -> column index
data_map = {}
for idx, (year, semester) in enumerate(columns):
    if pd.isna(year) or pd.isna(semester):
        continue
    if year not in data_map:
        data_map[year] = {}
    data_map[year][semester] = idx + 1  # +1 to match df columns

st.title("Academic Hours Distribution")

# Select name
selected_name = st.selectbox("Select Staff Name", list(names))

# Select year
selected_year = st.selectbox("Select Academic Year", list(data_map.keys()))

# Filter semesters for selected year
semesters = list(data_map[selected_year].keys()) if selected_year in data_map else []
selected_semester = st.selectbox("Select Semester", semesters)

# Show result
if st.button("Get Academic Hours"):
    if selected_name and selected_year and selected_semester:
        col_idx = data_map.get(selected_year, {}).get(selected_semester)
        row = df[df.iloc[:, 0] == selected_name]
        value = row.iloc[0, col_idx] if not row.empty else "N/A"
        st.success(f"Academic Hours for {selected_name} in {selected_year} - {selected_semester}: {value}")
    else:
        st.warning("Please select all options.")
